class CultivationMap{constructor(t){this.canvas=document.getElementById(t),this.canvas_width=this.canvas.clientWidth,this.canvas_height=this.canvas.clientHeight,this.ctx=this.canvas.getContext("2d"),this.dead_pat=new Image,this.dead_pat.src="./img/pluspat1.png",this.dead_color={},this.dead_area_set=[],this.plant_color={},this.plant_area_set=[],this.direction=new Image,this.direction.src="./img/direction1.png",this.garden_w=100,this.garden_h=100,this.set_font("12px 'MS P Gothic'"),this.set_direction(null,0,0)}set_garden_size(t,e){this.garden_w=t,this.garden_h=e}set_font(t){this.ctx.font=t,this.font_size=parseInt(t.match(/(\d+)px/)[1])}set_dead_color(t,e){this.dead_color[t]=e}add_dead(t,e,i,s,a){this.dead_area_set.push({dead_name:t,x:e,y:i,w:s,h:a})}set_plant_color(t,e){this.plant_color[t]=e}add_plant(t,e,i,s,a){this.plant_area_set.push({plant_name:t,x:e,y:i,w:s,h:a})}draw(){for(let t=0;t<this.dead_area_set.length;t++){let e=this.dead_area_set[t];this.draw_dead_(e,this.dead_color[e.dead_name])}for(let i=0;i<this.plant_area_set.length;i++){let s=this.plant_area_set[i];this.draw_plant_(s,this.plant_color[s.plant_name])}null!=this.ang&&this.draw_direction_(this.ang,this.ang_x,this.ang_y),this.ctx.strokeStyle="black",this.ctx.strokeRect(0,0,this.canvas_width,this.canvas_height)}draw_dead_(t,e){let{x:i,y:s,w:a,h}=this.get_rect_(t);this.ctx.fillStyle=e,this.ctx.fillRect(i,s,a,h);let n=this.ctx.createPattern(this.dead_pat,"repeat");this.ctx.fillStyle=n,this.ctx.fillRect(i,s,a,h)}draw_plant_(t,e){this.ctx.fillStyle=e;let{x:i,y:s,w:a,h}=this.get_rect_(t);this.ctx.fillRect(i,s,a,h);let n=this.ctx.measureText(t.plant_name),l=i+(a-n.width)/2,c=s+(h+this.font_size)/2;this.ctx.fillStyle="black",this.ctx.fillText(t.plant_name,l,c)}get_rect_(t){let e=this.canvas_width/this.garden_w,i=this.canvas_height/this.garden_h,s=t.x*e,a=t.y*i,h=t.w*e,n=t.h*i;return{x:s,y:a,w:h,h:n}}set_direction(t,e,i){this.ang=t,this.ang_x=e,this.ang_y=i}draw_direction_(t,e,i){this.ctx.save(),this.ctx.translate(25+e,25+i),this.ctx.rotate(t*Math.PI/180),this.ctx.translate(-25,-25),this.ctx.drawImage(this.direction,0,0),this.ctx.restore()}}